{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552178942433_1788060020","id":"20190310-004902_315923817","dateCreated":"2019-03-10T00:49:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2872","text":"// task A\n// zeppelin console won't print the whole file, but this works\nimport java.io.PrintWriter;\nval wapFile = sc.textFile(\"/user/zeppelin/wap.txt\");\nval flattenMap = wapFile.flatMap(line => line.split(\"\\\\s+\"));\nval mapreduce = flattenMap.map(word => (word, 1)).reduceByKey((a,b) => a+b);\nval result = mapreduce.filter{case (key, value) => value >= 5 && value <= 7};\nresult foreach {case (key, value) => println (key)};","dateUpdated":"2019-03-10T00:59:48+0000","dateFinished":"2019-03-10T00:56:50+0000","dateStarted":"2019-03-10T00:56:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.io.PrintWriter\nwapFile: org.apache.spark.rdd.RDD[String] = /user/zeppelin/wap.txt MapPartitionsRDD[86] at textFile at <console>:40\nflattenMap: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[87] at flatMap at <console>:42\nmapreduce: org.apache.spark.rdd.RDD[(String, Int)] = ShuffledRDD[89] at reduceByKey at <console>:44\nresult: org.apache.spark.rdd.RDD[(String, Int)] = MapPartitionsRDD[90] at filter at <console>:46\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552179565322_1587846096","id":"20190310-005925_1595582552","dateCreated":"2019-03-10T00:59:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3670","text":"// task B\nimport scala.util.matching.Regex;\nval wapFile = sc.textFile(\"/user/zeppelin/wap.txt\");\nval flattenMap = wapFile.flatMap(line => line.split(\"\\\\s+\"));\nval pattern = new Regex(\"a|e|i|o|u\");\ndef matchVowels(word: String) : String = {\n\tvar vowels: String = \"\";\n\tval matches = pattern.findAllIn(word);\n\tif(!matches.isEmpty) matches.foreach {vowels += _};\n\treturn vowels;\n};\nval mapreduce = flattenMap.map(word => (matchVowels(word), 1)).reduceByKey((a,b) => a+b);\nval max_val = mapreduce.max()(Ordering[Int].on(x=>x._2));\nprintln(max_val);","dateUpdated":"2019-03-10T00:59:59+0000","dateFinished":"2019-03-10T01:00:02+0000","dateStarted":"2019-03-10T00:59:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.util.matching.Regex\nwapFile: org.apache.spark.rdd.RDD[String] = /user/zeppelin/wap.txt MapPartitionsRDD[92] at textFile at <console>:41\nflattenMap: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[93] at flatMap at <console>:43\npattern: scala.util.matching.Regex = a|e|i|o|u\nmatchVowels: (word: String)String\nmapreduce: org.apache.spark.rdd.RDD[(String, Int)] = ShuffledRDD[95] at reduceByKey at <console>:49\nmax_val: (String, Int) = (a,88484)\n(a,88484)\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552179608257_-1680348979","id":"20190310-010008_667362086","dateCreated":"2019-03-10T01:00:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3756","text":"// load table for task C and D\nval taxi = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/taxi.csv\")\n\ntaxi.createOrReplaceTempView(\"taxiView\")","dateUpdated":"2019-03-10T01:11:09+0000","dateFinished":"2019-03-10T01:09:24+0000","dateStarted":"2019-03-10T01:06:19+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"taxi: org.apache.spark.sql.DataFrame = [VendorID: int, tpep_pickup_datetime: timestamp ... 17 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552179960900_-551771018","id":"20190310-010600_1642194655","dateCreated":"2019-03-10T01:06:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3948","text":"// task C\nspark.sqlContext.sql(\"SELECT CASE WHEN fare_amount >= 0 AND fare_amount <= 24.99 THEN '$0 - $24.99'\tWHEN fare_amount >= 25 AND fare_amount <= 49.99 THEN '$25 - $49.99' WHEN fare_amount >= 50 AND fare_amount <= 74.99 THEN '$50 - $74.99' ELSE '$75+' END AS fare_group, (avg(tip_amount) / avg(fare_amount)) AS avg_tips FROM taxiView GROUP BY CASE WHEN fare_amount >= 0 AND fare_amount <= 24.99 THEN '$0 - $24.99'\tWHEN fare_amount >= 25 AND fare_amount <= 49.99 THEN '$25 - $49.99' WHEN fare_amount >= 50 AND fare_amount <= 74.99 THEN '$50 - $74.99' ELSE '$75+' END\").show()","dateUpdated":"2019-03-10T01:09:30+0000","dateFinished":"2019-03-10T01:09:59+0000","dateStarted":"2019-03-10T01:09:30+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-------------------+\n|  fare_group|           avg_tips|\n+------------+-------------------+\n| $0 - $24.99|0.13709185772756213|\n|        $75+|0.06551128499217691|\n|$50 - $74.99|0.13360785323091612|\n|$25 - $49.99| 0.1452681632879384|\n+------------+-------------------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552179634662_810961446","id":"20190310-010034_465568691","dateCreated":"2019-03-10T01:00:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3830","text":"// task D\nspark.sqlContext.sql(\"SELECT trip_distance, cost FROM (SELECT trip_distance, (avg(fare_amount)/avg(trip_distance)) as cost FROM\ttaxiView WHERE trip_distance != 0 GROUP BY trip_distance) GROUP BY trip_distance, cost ORDER BY cost DESC LIMIT 10\").show()","dateUpdated":"2019-03-10T01:04:46+0000","dateFinished":"2019-03-10T01:05:18+0000","dateStarted":"2019-03-10T01:04:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------------------+\n|trip_distance|              cost|\n+-------------+------------------+\n|         0.01| 1413.294063365124|\n|        158.6| 838.9523329129887|\n|         0.02|503.80918580375766|\n|         0.03| 313.6552279684231|\n|         0.04|234.06705539358583|\n|         0.05| 174.3070221066324|\n|         0.06| 119.2789187913128|\n|         0.07|104.03852080123251|\n|         0.08|102.18502425222304|\n|         0.09| 76.41148775894546|\n+-------------+------------------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552179188302_-1799602525","id":"20190310-005308_386017972","dateCreated":"2019-03-10T00:53:08+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3104"}],"name":"ActivitySeven","id":"2E6T9W6BX","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}